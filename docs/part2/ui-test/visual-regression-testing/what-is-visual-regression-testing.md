# 📌 시각적 회귀 테스트 (Visual Regression Testing)
~~~
시각적 회귀 테스트(Visual Regression Testing, VRT)는 UI의 시각적 요소가 변경되지 않았는지 확인하는 테스트 방식입니다.
기존 스냅샷 테스트(toMatchSnapshot())는 HTML 구조만 비교하지만, 시각적 회귀 테스트는 실제 렌더링된 UI의 "이미지"를 비교하여 변경 사항을 감지합니다.
~~~

---

## ✅ 시각적 회귀 테스트의 동작 방식

1. **Baseline(기준) 이미지 생성**  
   - 첫 테스트 실행 시, 현재 UI의 스크린샷을 찍어 "기준 이미지"로 저장  
2. **새로운 UI 상태와 비교**  
   - 다음 테스트 실행 시, 현재 UI의 스크린샷을 다시 찍어서 기존 기준 이미지와 비교  
3. **차이점(픽셀 단위 변경) 감지**  
   - 픽셀 단위로 변경 사항을 감지하여 UI가 의도치 않게 깨졌는지 확인  
4. **테스트 결과 제공**  
   - 변경 사항이 있으면 **테스트 실패**, 변경이 없으면 **테스트 통과**  
   - UI가 의도적으로 변경된 경우 **기준 이미지를 업데이트**  

---

## 🎯 기존 스냅샷 테스트와의 차이점

|  | **스냅샷 테스트 (Snapshot Test)** | **시각적 회귀 테스트 (Visual Regression Test)** |
|---|---|---|
| 비교 대상 | HTML 구조 (DOM) | UI가 실제 렌더링된 이미지 |
| 감지 가능한 변경 사항 | **구조적 변경 (ex: 요소 추가/삭제)** | **스타일 변경 (ex: 색상, 위치, 크기 변화)** |
| CSS 변경 감지 | ❌ 감지 불가 | ✅ 감지 가능 |
| 픽셀 단위 변경 감지 | ❌ 감지 불가 | ✅ 감지 가능 |
| 활용 사례 | 컴포넌트 렌더링이 올바르게 되는지 확인 | UI 디자인이 변경되지 않았는지 확인 |

💡 **즉, 시각적 회귀 테스트는 UI의 스타일이 깨지는 걸 방지하는 데 효과적입니다!** 🚀

---

## 🚀 시각적 회귀 테스트(VRT), 언제 하면 좋을까?

✅ 리팩토링 후 UI 영향이 없는지 확인할 때<br/>
✅ CSS나 스타일을 변경했을 때<br/>
✅ 새로운 기능을 추가했을 때 기존 화면이 망가지는지 테스트할 때<br/>
✅ 반응형 디자인(모바일, 다크 모드 등) 확인할 때<br/>
✅ 배포 전 전체적인 UI 검증할 때<br/>

💡 VRT는 “내가 코드만 바꿨는데 UI가 깨지면 안 되는 상황”에서 꼭 필요한 테스트!

---

## 🔧 시각적 회귀 테스트 도구

> 시각적 회귀 테스트를 지원하는 대표적인 도구들은 아래와 같습니다.

### 1️⃣ **Chromatic (Storybook 연동)**
- **Storybook과 함께 사용 가능**  
- Storybook의 UI 컴포넌트 상태를 자동으로 캡처하고, 변경 사항을 감지  
- UI가 변경되었을 때 **PR에서 리뷰 후 승인 가능**

### 2️⃣ Percy (BrowserStack 제공)
- 다양한 브라우저와 해상도에서 시각적 비교 가능
- CI/CD와 연동 가능 (GitHub Actions, GitLab CI 등)
- 특정 요소만 테스트할 수도 있음

### 3️⃣ Loki (Storybook 기반 VRT)
- Storybook 컴포넌트 테스트에 특화됨
- Puppeteer, Playwright, Chrome 등을 활용해 UI 변경 감지