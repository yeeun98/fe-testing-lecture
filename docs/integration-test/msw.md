## ğŸ§ª mswë¡œ API ëª¨í‚¹í•˜ê¸°

>í†µí•© í…ŒìŠ¤íŠ¸ì—ì„œ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” **TanStack Query ì„¤ì •**ê³¼ **API ëª¨í‚¹(Mocking)**ì´ í•„ìš”í•©ë‹ˆë‹¤.

<br>

## âœ”ï¸ TanStack Query

> **TanStack Query**ëŠ” API í˜¸ì¶œì— ë”°ë¥¸ **ë¡œë”©, ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬, í˜ì´ì§€ë„¤ì´ì…˜ ìºì‹±** ë“±ì˜ í¸ì˜ì„±ì„ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬.
> í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” ê¸°ì¡´ ì„¤ì •(ex: `retry`)ì´ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šë„ë¡ ì„¤ì •ì„ ì¡°ì •í•´ì•¼í•œë‹¤.

### í…ŒìŠ¤íŠ¸ìš© ì„¤ì • (ì˜ˆ: `render.jsx`)
- **Retry ë¹„í™œì„±í™”:** í…ŒìŠ¤íŠ¸ ì¤‘ ë¶ˆí•„ìš”í•œ ì¬ì‹œë„ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ `retry` ì˜µì…˜ì„ êº¼ì•¼ í•©ë‹ˆë‹¤.
- **í…ŒìŠ¤íŠ¸ ìºì‹± ê´€ë¦¬:** ê° í…ŒìŠ¤íŠ¸ë§ˆë‹¤ ì´ˆê¸°í™”ëœ ìƒíƒœë¥¼ ìœ ì§€í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

    ```jsx
    import { QueryClient, QueryClientProvider } from '@tanstack/react-query';

    // í…ŒìŠ¤íŠ¸ ì „ìš© Query Client ì„¤ì •
    const createTestQueryClient = () =>
    new QueryClient({
        defaultOptions: {
        queries: {
            retry: false, // ì¬ì‹œë„ ë¹„í™œì„±í™”
            cacheTime: 0, // ìºì‹± ë¹„í™œì„±í™”
        },
        },
    });

    // Query Clientë¥¼ í¬í•¨í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¤ì •
    const renderWithClient = (ui) => {
    const testQueryClient = createTestQueryClient();
    return render(
        <QueryClientProvider client={testQueryClient}>
        {ui}
        </QueryClientProvider>
    );
    };
    ```

<br/>

## âœ”ï¸ Mock Service Worker (MSW)

> `Mock Service Worker(MSW)`ëŠ” **Node.js**ì™€ **ë¸Œë¼ìš°ì € í™˜ê²½**ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **API ëª¨í‚¹ ë¼ì´ë¸ŒëŸ¬ë¦¬**ì´ë‹¤.

- ë¸Œë¼ìš°ì € í™˜ê²½: `ì„œë¹„ìŠ¤ ì›Œì»¤(Service Worker)`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ê°€ë¡œì±•ë‹ˆë‹¤.
- Node.js í™˜ê²½: `XHR, Fetch ë“±ì˜ ìš”ì²­ì„ ì¸í„°ì…‰íŠ¸í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬`ë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### MSW ì„¤ì •
- **setupê³¼ teardown í™œìš©:**  
  í…ŒìŠ¤íŠ¸ ì‹¤í–‰ **ì „**ì— API ëª¨í‚¹ì„ í™œì„±í™”í•˜ê³ , í…ŒìŠ¤íŠ¸ ì‹¤í–‰ **í›„**ì— ì´ë¥¼ í•´ì œí•˜ì—¬ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.

  ```js
   // setupTests.js
    import { handlers } from '@/__mocks__/handlers';

    /* msw */
    export const server = setupServer(...handlers);

    beforeAll(() => {
        server.listen();
    });

    afterEach(() => {
        server.resetHandlers();
        // ëª¨í‚¹ëœ ëª¨ì˜ ê°ì²´ í˜¸ì¶œì— ëŒ€í•œ íˆìŠ¤í† ë¦¬ë¥¼ ì´ˆê¸°í™”
        // ëª¨í‚¹ëœ ëª¨ë“ˆì˜ êµ¬í˜„ì„ ì´ˆê¸°í™”í•˜ì§€ ì•ŠëŠ”ë‹¤. -> ëª¨í‚¹ëœ ìƒíƒœë¡œ ìœ ì§€ë¨
        // -> ëª¨í‚¹ ëª¨ë“ˆ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ê°€ ì˜¬ë°”ë¥´ê²Œ ì‹¤í–‰
        // ë°˜ë©´, ëª¨í‚¹ íˆìŠ¤í† ë¦¬ê°€ ê³„ì† ìŒ“ì„(í˜¸ì¶œ íšŸìˆ˜ë‚˜ ì¸ìê°€ ê³„ì† ë³€ê²½) -> ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŒ
        vi.clearAllMocks();
    });

    afterAll(() => {
        // ëª¨í‚¹ ëª¨ë“ˆì— ëŒ€í•œ ëª¨ë“  êµ¬í˜„ì„ ì´ˆê¸°í™”
        vi.resetAllMocks();
        server.close();
    });
  ```


### ğŸ‘©ğŸ»â€ğŸ’» ì˜ˆì œ ì½”ë“œ

#### MSW í•¸ë“¤ëŸ¬ ì •ì˜
```javascript
import { rest } from 'msw';

export const handlers = [
  rest.get('/api/user', (req, res, ctx) => {
    return res(
      ctx.status(200),
      ctx.json({ id: '123', username: 'test_user' })
    );
  }),
];
```

<br>

## ğŸ¯ ìš”ì•½

### TanStack Query
	â€¢	API í˜¸ì¶œ í¸ì˜ì„± ì œê³µ (ë¡œë”©, ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬, ìºì‹± ë“±).
	â€¢	í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” retry ë¹„í™œì„±í™”, ìºì‹± ì´ˆê¸°í™” ì„¤ì • í•„ìš”.

### Mock Service Worker (MSW)
	â€¢	API ëª¨í‚¹ì„ í†µí•´ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ì‹œë®¬ë ˆì´ì…˜.
	â€¢	ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œëŠ” ì„œë¹„ìŠ¤ ì›Œì»¤ë¥¼, Node.js í™˜ê²½ì—ì„œëŠ” XHR ì¸í„°ì…‰í„° ì‚¬ìš©.
	â€¢	í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „í›„ë¡œ setupê³¼ teardownì„ í†µí•´ ëª¨í‚¹ í™œì„±í™”/í•´ì œ.